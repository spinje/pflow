---
title: "MCP tools"
description: "Use tools from MCP servers"
icon: "plug"
---

<Note>
  **Agent commands.** Your AI agent uses MCP nodes in workflows. You manage MCP servers with `pflow mcp` commands.
</Note>

MCP (Model Context Protocol) lets you extend pflow with external tools. When you add an MCP server, its tools become pflow nodes that your agent can use in workflows.

## How it works

1. **Add an MCP server** with `pflow mcp add`
2. **Sync tools** with `pflow mcp sync` (or let auto-sync handle it)
3. **Tools become nodes** named `mcp-{server}-{tool}`
4. **Agent uses them** like any other node

```bash
# Add a GitHub MCP server
pflow mcp add github.mcp.json

# Tools are now available
pflow registry list --group mcp
# mcp-github-create_issue
# mcp-github-list_repos
# mcp-github-search_code
```

## Node naming

MCP tools become nodes with the pattern `mcp-{server}-{tool}`:

| Server | Tool | Node name |
|--------|------|-----------|
| github | create_issue | `mcp-github-create_issue` |
| slack | send_message | `mcp-slack-send_message` |
| filesystem | read_file | `mcp-filesystem-read_file` |

## Parameters

MCP node parameters come directly from the tool's input schema. Each MCP server defines its own tools with their own parameters.

To see a tool's parameters:

```bash
pflow registry describe mcp-github-create_issue
```

## Output

All MCP nodes write to:

| Key | Type | Description |
|-----|------|-------------|
| `result` | any | Tool execution result |
| `{server}_{tool}_result` | any | Same result with unique key |
| `error` | str | Error message (only on failure) |

For dict results, top-level fields are also extracted directly:

```json
// Tool returns: {"issue_url": "...", "issue_number": 123}
// Shared store contains:
{
  "result": {"issue_url": "...", "issue_number": 123},
  "github_create_issue_result": {"issue_url": "...", "issue_number": 123},
  "issue_url": "...",
  "issue_number": 123
}
```

## Example workflow

```json
{
  "nodes": [
    {
      "id": "create_issue",
      "type": "mcp-github-create_issue",
      "params": {
        "repository": "myorg/myrepo",
        "title": "Bug: ${error_summary}",
        "body": "${error_details}"
      }
    },
    {
      "id": "notify",
      "type": "mcp-slack-send_message",
      "params": {
        "channel": "#alerts",
        "text": "Created issue: ${create_issue.issue_url}"
      }
    }
  ]
}
```

## Adding MCP servers

See [Adding MCP servers](/guides/adding-mcp-servers) for detailed setup instructions.

Quick examples:

```bash
# From config file
pflow mcp add github.mcp.json

# From JSON string
pflow mcp add '{"filesystem": {"command": "npx", "args": ["-y", "@modelcontextprotocol/server-filesystem", "/Users/me/data"]}}'
```

## Managing servers

```bash
# List configured servers
pflow mcp list

# See available tools
pflow mcp tools github

# Get tool details
pflow mcp info github create_issue

# Remove a server
pflow mcp remove github
```

## Transport types

MCP servers can run locally or remotely:

| Transport | Use case | Example |
|-----------|----------|---------|
| **stdio** | Local subprocess | `npx @modelcontextprotocol/server-filesystem` |
| **http** | Remote server | `https://mcp.example.com/api` |

Both work the same way once configured. See [Adding MCP servers](/guides/adding-mcp-servers) for configuration details.

## Authentication

MCP servers may require authentication. This is configured when adding the server:

```json
{
  "github": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-github"],
    "env": {
      "GITHUB_TOKEN": "${GITHUB_TOKEN}"
    }
  }
}
```

For HTTP servers with auth:

```json
{
  "my-api": {
    "url": "https://mcp.example.com/sse",
    "headers": {
      "Authorization": "Bearer ${API_TOKEN}"
    }
  }
}
```

## Error handling

MCP nodes return `error` action on:

- **Connection failure**: Server not reachable
- **Tool error**: Tool reported an error (via `isError` flag)
- **Timeout**: Request took too long (default 30 seconds)

The node does **not** retry automatically - MCP calls start a server subprocess, and retries would cause resource conflicts.

## Auto-sync

When you run a workflow, pflow automatically syncs MCP tools if the server configuration has changed. You don't need to manually run `pflow mcp sync` after adding servers.

Manual sync is useful for:
- Testing connection immediately after adding a server
- Debugging connection issues
- Forcing re-discovery without running a workflow
