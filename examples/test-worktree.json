{
  "name": "git-worktree-task-creator",
  "description": "Automatically creates git worktrees for development tasks by analyzing task descriptions with LLM to determine branch types, names, and worktree paths. Checks repository state, generates appropriate branch names following conventional patterns (feat/fix/docs/refactor/test), creates worktrees with cleanup of existing ones, and outputs ready-to-use development environment commands for Cursor and Claude Code editors.",
  "ir": {
    "ir_version": "1.0.0",
    "nodes": [
      {
        "id": "git_status",
        "type": "shell",
        "purpose": "Check git repository status to understand current state",
        "params": {
          "command": "git status --short"
        }
      },
      {
        "id": "git_current_branch",
        "type": "shell",
        "purpose": "Get current git branch name for reference",
        "params": {
          "command": "git branch --show-current"
        }
      },
      {
        "id": "get_directory",
        "type": "shell",
        "purpose": "Get current directory name for worktree path generation",
        "params": {
          "command": "basename $(pwd)"
        }
      },
      {
        "id": "analyze_task",
        "type": "llm",
        "purpose": "Analyze task description to determine branch type, name and worktree paths",
        "params": {
          "prompt": "Analyze the task description and current directory to generate git worktree information.\n\nTask: ${task_description}\nCurrent Directory: ${get_directory.stdout}\n\nBased on the task, determine:\n1. Branch type using these rules:\n   - If task contains 'implement', 'add', 'create', 'build' \u2192 use 'feat'\n   - If task contains 'fix', 'bug', 'repair', 'resolve' \u2192 use 'fix'\n   - If task contains 'document', 'docs', 'readme' \u2192 use 'docs'\n   - If task contains 'refactor', 'restructure', 'reorganize' \u2192 use 'refactor'\n   - If task contains 'test', 'testing', 'spec' \u2192 use 'test'\n   - Default to 'feat' if unclear\n\n2. Branch name (kebab-case, 2-4 words, remove articles):\n   - Extract key words from task\n   - Convert to lowercase with hyphens\n   - Remove 'a', 'an', 'the', 'node' and common words\n\n3. Generate paths and names:\n   - Worktree directory: ../[current-dir]-[branch-type]-[branch-name]\n   - Full branch name: [branch-type]/[branch-name]\n\nRespond ONLY with this exact format:\nBRANCH_TYPE=[branch-type]\nBRANCH_NAME=[branch-name]\nWORKTREE_PATH=../[current-dir]-[branch-type]-[branch-name]\nFULL_BRANCH=[branch-type]/[branch-name]",
          "model": "gemini-2.5-flash-lite",
          "temperature": 0.3
        }
      },
      {
        "id": "remove_existing_worktree",
        "type": "shell",
        "purpose": "Remove any existing worktree at the target location",
        "params": {
          "command": "WORKTREE_PATH=$(echo '${analyze_task.response}' | grep '^WORKTREE_PATH=' | cut -d'=' -f2) && git worktree remove \"$WORKTREE_PATH\" 2>/dev/null || true",
          "ignore_errors": true
        }
      },
      {
        "id": "create_worktree",
        "type": "shell",
        "purpose": "Create new git worktree with the generated branch",
        "params": {
          "command": "WORKTREE_PATH=$(echo '${analyze_task.response}' | grep '^WORKTREE_PATH=' | cut -d'=' -f2) && FULL_BRANCH=$(echo '${analyze_task.response}' | grep '^FULL_BRANCH=' | cut -d'=' -f2) && git worktree add \"$WORKTREE_PATH\" -B \"$FULL_BRANCH\""
        }
      },
      {
        "id": "output_status",
        "type": "shell",
        "purpose": "Output worktree creation status",
        "params": {
          "command": "WORKTREE_PATH=$(echo '${analyze_task.response}' | grep '^WORKTREE_PATH=' | cut -d'=' -f2) && echo \"\u2705 Worktree created at $WORKTREE_PATH\""
        }
      },
      {
        "id": "launch_cursor",
        "type": "shell",
        "purpose": "Launch Cursor in the new worktree directory if requested",
        "params": {
          "command": "OPEN_CURSOR='${open_cursor}' && echo \"DEBUG: open_cursor value is: '$OPEN_CURSOR'\" && WORKTREE_PATH=$(echo '${analyze_task.response}' | grep '^WORKTREE_PATH=' | cut -d'=' -f2) && if [ \"$OPEN_CURSOR\" != 'false' ] && [ \"$OPEN_CURSOR\" != 'False' ] && [ \"$OPEN_CURSOR\" != '0' ]; then cursor \"$WORKTREE_PATH\" && echo 'Cursor launched'; else echo 'Skipping Cursor'; fi",
          "ignore_errors": true
        }
      },
      {
        "id": "launch_claude",
        "type": "shell",
        "purpose": "Launch Claude Code in the new worktree with task context if requested",
        "params": {
          "command": "OPEN_CLAUDE='${open_claude}' && echo \"DEBUG: open_claude value is: '$OPEN_CLAUDE'\" && WORKTREE_PATH=$(echo '${analyze_task.response}' | grep '^WORKTREE_PATH=' | cut -d'=' -f2) && FULL_BRANCH=$(echo '${analyze_task.response}' | grep '^FULL_BRANCH=' | cut -d'=' -f2) && FULL_WORKTREE_PATH=$(cd \"$WORKTREE_PATH\" && pwd) && if [ \"$OPEN_CLAUDE\" != 'false' ] && [ \"$OPEN_CLAUDE\" != 'False' ] && [ \"$OPEN_CLAUDE\" != '0' ]; then osascript <<EOF\ntell application \"Terminal\"\n    activate\n    do script \"cd $FULL_WORKTREE_PATH && claude --dangerously-skip-permissions 'You have been assigned to work in a dedicated git worktree for this task. Current worktree: $FULL_WORKTREE_PATH, Branch: $FULL_BRANCH, Original request: ${task_description}. You are now in an isolated git worktree specifically created for this task. All changes you make here are completely separate from the main branch. Please wait for the user to provide specific instructions on how to proceed with: ${task_description}. Do not do anything until the user has provided specific instructions. STOP and WAIT after this message.'\"\nend tell\nEOF\necho 'Claude launched in Terminal'; else echo 'Skipping Claude'; fi",
          "ignore_errors": true
        }
      }
    ],
    "edges": [
      {
        "from": "git_status",
        "to": "git_current_branch",
        "action": "default"
      },
      {
        "from": "git_current_branch",
        "to": "get_directory",
        "action": "default"
      },
      {
        "from": "get_directory",
        "to": "analyze_task",
        "action": "default"
      },
      {
        "from": "analyze_task",
        "to": "remove_existing_worktree",
        "action": "default"
      },
      {
        "from": "remove_existing_worktree",
        "to": "create_worktree",
        "action": "default"
      },
      {
        "from": "create_worktree",
        "to": "output_status",
        "action": "default"
      },
      {
        "from": "output_status",
        "to": "launch_cursor",
        "action": "default"
      },
      {
        "from": "launch_cursor",
        "to": "launch_claude",
        "action": "default"
      }
    ],
    "start_node": "git_status",
    "inputs": {
      "task_description": {
        "type": "string",
        "description": "Development task description to create a git worktree for",
        "required": true
      },
      "open_cursor": {
        "type": "boolean",
        "description": "Whether to open Cursor in the new worktree",
        "required": false,
        "default": true
      },
      "open_claude": {
        "type": "boolean",
        "description": "Whether to open Claude Code in the new worktree",
        "required": false,
        "default": true
      }
    },
    "outputs": {
      "status": {
        "description": "Status of worktree creation",
        "source": "${output_status.stdout}"
      },
      "worktree_creation_status": {
        "description": "Status output from creating the git worktree",
        "source": "${create_worktree.stdout}"
      },
      "branch_analysis": {
        "description": "Analyzed branch information including type, name, and paths",
        "source": "${analyze_task.response}"
      }
    }
  },
  "created_at": "2025-09-16T12:44:55.325305+00:00",
  "updated_at": "2025-09-16T12:44:55.325305+00:00",
  "version": "1.0.0",
  "rich_metadata": {
    "search_keywords": [
      "git worktree",
      "branch creation",
      "development workflow",
      "task automation",
      "git branch",
      "development environment",
      "llm analysis",
      "cursor editor",
      "claude code",
      "automated setup"
    ],
    "capabilities": [
      "Automatically determine branch type from task description using conventional patterns (feat/fix/docs/refactor/test)",
      "Generate kebab-case branch names from natural language task descriptions",
      "Create git worktrees with intelligent path naming based on current directory",
      "Clean up existing worktrees to avoid conflicts",
      "Automatically launch Cursor editor in new worktree (configurable)",
      "Automatically launch Claude Code in new Terminal window with full task context (configurable)",
      "Analyze repository state before making changes",
      "Follow git flow conventions for branch naming",
      "Use -B flag to create or reset branches avoiding naming conflicts",
      "Provide configurable editor launching via open_cursor and open_claude inputs"
    ],
    "typical_use_cases": [
      "Starting new development tasks with proper git workflow setup and automatic editor launch",
      "Automating repetitive git worktree creation for feature development",
      "Maintaining consistent branch naming conventions across development team",
      "Quick setup of isolated development environments with one command",
      "Creating feature branches with automatic Cursor and Claude Code integration"
    ]
  }
}
